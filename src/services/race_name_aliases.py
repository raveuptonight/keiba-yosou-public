"""
レース名エイリアス（別名）マッピング

ユーザーが一般的な通称で検索できるように、
正式名称へのマッピングを提供
"""

from typing import Dict, List

# レース名エイリアス（通称 → 正式名称の一部）
RACE_NAME_ALIASES: Dict[str, List[str]] = {
    # G1レース
    "日本ダービー": ["東京優駿"],
    "ダービー": ["東京優駿", "ダービー"],
    "皐月賞": ["皐月賞"],
    "桜花賞": ["桜花賞"],
    "オークス": ["優駿牝馬"],
    "優駿牝馬": ["優駿牝馬"],
    "菊花賞": ["菊花賞"],
    "天皇賞春": ["天皇賞（春）", "天皇賞(春)"],
    "天皇賞秋": ["天皇賞（秋）", "天皇賞(秋)"],
    "宝塚記念": ["宝塚記念"],
    "有馬記念": ["有馬記念"],
    "ジャパンカップ": ["ジャパンカップ", "ジャパンＣ"],
    "安田記念": ["安田記念"],
    "マイルチャンピオンシップ": ["マイルチャンピオンシップ", "マイルＣＳ"],
    "マイルCS": ["マイルチャンピオンシップ", "マイルＣＳ"],
    "スプリンターズステークス": ["スプリンターズステークス", "スプリンターズＳ"],
    "スプリンターズS": ["スプリンターズステークス", "スプリンターズＳ"],
    "エリザベス女王杯": ["エリザベス女王杯"],
    "秋華賞": ["秋華賞"],
    "フェブラリーステークス": ["フェブラリーステークス", "フェブラリーＳ"],
    "フェブラリーS": ["フェブラリーステークス", "フェブラリーＳ"],
    "高松宮記念": ["高松宮記念"],
    "大阪杯": ["大阪杯"],
    "ヴィクトリアマイル": ["ヴィクトリアマイル"],

    # 2歳G1
    "朝日杯": ["朝日杯フューチュリティステークス", "朝日杯ＦＳ"],
    "朝日杯FS": ["朝日杯フューチュリティステークス", "朝日杯ＦＳ"],
    "阪神ジュベナイルフィリーズ": ["阪神ジュベナイルフィリーズ", "阪神ＪＦ"],
    "阪神JF": ["阪神ジュベナイルフィリーズ", "阪神ＪＦ"],
    "ホープフルステークス": ["ホープフルステークス", "ホープフルＳ"],
    "ホープフルS": ["ホープフルステークス", "ホープフルＳ"],

    # 牝馬G1
    "桜花": ["桜花賞"],
    "オークス": ["優駿牝馬"],
    "秋華": ["秋華賞"],

    # その他主要レース
    "NHKマイル": ["ＮＨＫマイルカップ", "ＮＨKマイルＣ"],
    "NHKマイルC": ["ＮＨＫマイルカップ", "ＮＨKマイルＣ"],
    "チャンピオンズカップ": ["チャンピオンズカップ", "チャンピオンズＣ"],
    "チャンピオンズC": ["チャンピオンズカップ", "チャンピオンズＣ"],
}


def expand_race_name_query(query: str) -> List[str]:
    """
    レース名クエリをエイリアスで展開

    Args:
        query: ユーザーが入力したレース名

    Returns:
        検索すべきレース名のリスト（元のクエリ + エイリアス）
    """
    query_lower = query.lower().strip()

    # エイリアスマッピングを確認
    search_terms = [query]  # 元のクエリも含める

    for alias, official_names in RACE_NAME_ALIASES.items():
        if alias.lower() == query_lower or alias.lower() in query_lower:
            search_terms.extend(official_names)
            break

    # 重複を削除
    return list(set(search_terms))


def get_primary_search_term(query: str) -> str:
    """
    最優先の検索語を取得

    Args:
        query: ユーザーが入力したレース名

    Returns:
        最優先で検索すべき語（エイリアスがあればその最初の正式名称、なければ元のクエリ）
    """
    query_lower = query.lower().strip()

    for alias, official_names in RACE_NAME_ALIASES.items():
        if alias.lower() == query_lower:
            return official_names[0]

    return query
